[ 2016-07-25T00:06:12+08:00 ] 121.42.0.66 /
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000329s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY view desc LIMIT 0,12   [ RunTime:0.000053s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000342s ]
SQL: SELECT `id`,`name`,`title`,`pid`,`sort`,`list_row`,`meta_title`,`keywords`,`description`,`template_index`,`template_lists`,`template_detail`,`template_edit`,`model`,`type`,`link_id`,`allow_publish`,`display`,`reply`,`check`,`reply_model`,`extend`,`create_time`,`update_time`,`status`,`icon` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000057s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( status=1 ) LIMIT 1   [ RunTime:0.000052s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY create_time desc LIMIT 0,10   [ RunTime:0.000062s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000049s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000063s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000042s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000121s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000155s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.010791s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010837s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000039s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000060s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000029s ]
INFO: [ app_end ] --END-- [ RunTime:0.000056s ]

[ 2016-07-25T03:15:13+08:00 ] 207.46.13.36 /
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000312s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY view desc LIMIT 0,12   [ RunTime:0.000053s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000384s ]
SQL: SELECT `id`,`name`,`title`,`pid`,`sort`,`list_row`,`meta_title`,`keywords`,`description`,`template_index`,`template_lists`,`template_detail`,`template_edit`,`model`,`type`,`link_id`,`allow_publish`,`display`,`reply`,`check`,`reply_model`,`extend`,`create_time`,`update_time`,`status`,`icon` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000060s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( status=1 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY create_time desc LIMIT 0,10   [ RunTime:0.000053s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000058s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000050s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000054s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000065s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000042s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000128s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000166s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.010759s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010792s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000028s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000062s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000031s ]
INFO: [ app_end ] --END-- [ RunTime:0.000060s ]

[ 2016-07-25T09:50:11+08:00 ] 213.128.81.66 /
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000303s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY view desc LIMIT 0,12   [ RunTime:0.000054s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000332s ]
SQL: SELECT `id`,`name`,`title`,`pid`,`sort`,`list_row`,`meta_title`,`keywords`,`description`,`template_index`,`template_lists`,`template_detail`,`template_edit`,`model`,`type`,`link_id`,`allow_publish`,`display`,`reply`,`check`,`reply_model`,`extend`,`create_time`,`update_time`,`status`,`icon` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000055s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( status=1 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY create_time desc LIMIT 0,10   [ RunTime:0.000047s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000038s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000123s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000157s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.010905s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010936s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000025s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000045s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000029s ]
INFO: [ app_end ] --END-- [ RunTime:0.000059s ]

[ 2016-07-25T13:30:52+08:00 ] 185.137.219.199 /
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000365s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY view desc LIMIT 0,12   [ RunTime:0.000051s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000332s ]
SQL: SELECT `id`,`name`,`title`,`pid`,`sort`,`list_row`,`meta_title`,`keywords`,`description`,`template_index`,`template_lists`,`template_detail`,`template_edit`,`model`,`type`,`link_id`,`allow_publish`,`display`,`reply`,`check`,`reply_model`,`extend`,`create_time`,`update_time`,`status`,`icon` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000056s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( status=1 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY create_time desc LIMIT 0,10   [ RunTime:0.000049s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000057s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000048s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000056s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000041s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000109s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000144s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.010798s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010844s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000028s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000049s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000029s ]
INFO: [ app_end ] --END-- [ RunTime:0.000057s ]

[ 2016-07-25T14:58:19+08:00 ] 185.137.219.199 /
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000320s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY view desc LIMIT 0,12   [ RunTime:0.000055s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000341s ]
SQL: SELECT `id`,`name`,`title`,`pid`,`sort`,`list_row`,`meta_title`,`keywords`,`description`,`template_index`,`template_lists`,`template_detail`,`template_edit`,`model`,`type`,`link_id`,`allow_publish`,`display`,`reply`,`check`,`reply_model`,`extend`,`create_time`,`update_time`,`status`,`icon` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000085s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( status=1 ) LIMIT 1   [ RunTime:0.000052s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY create_time desc LIMIT 0,10   [ RunTime:0.000064s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000047s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000049s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000046s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000086s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000058s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000055s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000039s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000106s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000140s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.010634s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010668s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000027s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000049s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000029s ]
INFO: [ app_end ] --END-- [ RunTime:0.000070s ]

[ 2016-07-25T17:11:34+08:00 ] 207.46.13.105 /
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000304s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY view desc LIMIT 0,12   [ RunTime:0.000054s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000329s ]
SQL: SELECT `id`,`name`,`title`,`pid`,`sort`,`list_row`,`meta_title`,`keywords`,`description`,`template_index`,`template_lists`,`template_detail`,`template_edit`,`model`,`type`,`link_id`,`allow_publish`,`display`,`reply`,`check`,`reply_model`,`extend`,`create_time`,`update_time`,`status`,`icon` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000060s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( status=1 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY create_time desc LIMIT 0,10   [ RunTime:0.000051s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000050s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000049s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000041s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000144s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000190s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.010699s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010734s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000028s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000051s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000030s ]
INFO: [ app_end ] --END-- [ RunTime:0.000060s ]

[ 2016-07-25T20:16:31+08:00 ] 27.38.12.207 /index.php?s=/Admin/Public/login/
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000037s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000069s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.001533s ]
INFO: [ view_parse ] --END-- [ RunTime:0.001582s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000026s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000047s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000023s ]
INFO: [ app_end ] --END-- [ RunTime:0.000043s ]

[ 2016-07-25T20:16:41+08:00 ] 27.38.12.207 /index.php?s=/Admin/Index/index.html
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000358s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000057s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Index/index%' ) LIMIT 1   [ RunTime:0.000035s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000245s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=1 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 1 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 1 ) AND ( `hide` = 0 )  [ RunTime:0.000048s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000083s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000114s ]
INFO: [ AdminIndex ] --START--
SQL: SHOW COLUMNS FROM `ot_addons` [ RunTime:0.000286s ]
SQL: SELECT `config` FROM `ot_addons` WHERE ( `name` = 'SiteStat' ) AND ( `status` = 1 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_member` [ RunTime:0.000339s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_member` LIMIT 1   [ RunTime:0.000102s ]
SQL: SHOW COLUMNS FROM `ot_action_log` [ RunTime:0.000274s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_action_log` LIMIT 1   [ RunTime:0.000080s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000294s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` LIMIT 1   [ RunTime:0.000080s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000336s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_category` LIMIT 1   [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_model` [ RunTime:0.000289s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_model` LIMIT 1   [ RunTime:0.000040s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000018s ]
INFO: [ template_filter ] --END-- [ RunTime:-0.005101s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.000871s ]
INFO: [ view_parse ] --END-- [ RunTime:0.000903s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000023s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000043s ]
INFO: Run SiteStat [ RunTime:0.004447s ]
SQL: SELECT `config` FROM `ot_addons` WHERE ( `name` = 'SystemInfo' ) AND ( `status` = 1 ) LIMIT 1   [ RunTime:0.000048s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000021s ]
INFO: [ template_filter ] --END-- [ RunTime:-0.006453s ]
SQL: select version() as v; [ RunTime:0.000069s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.001229s ]
INFO: [ view_parse ] --END-- [ RunTime:-0.000307s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000005s ]
INFO: [ view_filter ] --END-- [ RunTime:-0.001515s ]
INFO: Run SystemInfo [ RunTime:0.001527s ]
SQL: SELECT `config` FROM `ot_addons` WHERE ( `name` = 'DevTeam' ) AND ( `status` = 1 ) LIMIT 1   [ RunTime:0.000046s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000019s ]
INFO: [ template_filter ] --END-- [ RunTime:-0.007814s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.000776s ]
INFO: [ view_parse ] --END-- [ RunTime:-0.001856s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000005s ]
INFO: [ view_filter ] --END-- [ RunTime:-0.002614s ]
INFO: Run DevTeam [ RunTime:0.001091s ]
INFO: [ AdminIndex ] --END-- [ RunTime:0.007108s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.000871s ]
INFO: [ view_parse ] --END-- [ RunTime:-0.001856s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000004s ]
INFO: [ view_filter ] --END-- [ RunTime:-0.002700s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000025s ]
INFO: [ app_end ] --END-- [ RunTime:0.000054s ]

[ 2016-07-25T20:16:45+08:00 ] 163.125.54.192 /index.php?s=/Admin/Article/mydocument.html
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000350s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000048s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/mydocument%' ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000263s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_auth_group_access` [ RunTime:0.000229s ]
SQL: SELECT `extend_id` FROM ot_auth_group_access g INNER JOIN ot_auth_extend c on g.group_id=c.group_id  WHERE ( g.uid='1' and c.type='1' and !isnull(extend_id) )  [ RunTime:0.000043s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000321s ]
SQL: SELECT `id`,`title`,`pid`,`allow_publish` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY pid,sort  [ RunTime:0.000046s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000307s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( `status` IN ('0','1','2') ) AND ( `uid` = 1 ) AND ( `pid` = 0 ) LIMIT 1   [ RunTime:0.000242s ]
SQL: SELECT `id`,`uid`,`name`,`title`,`category_id`,`description`,`root`,`pid`,`model_id`,`type`,`position`,`link_id`,`cover_id`,`display`,`deadline`,`attach`,`view`,`comment`,`extend`,`level`,`create_time`,`update_time`,`status` FROM `ot_document` WHERE ( `status` IN ('0','1','2') ) AND ( `uid` = 1 ) AND ( `pid` = 0 ) ORDER BY update_time desc LIMIT 0,10   [ RunTime:0.000262s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000144s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000179s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000368s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( pid=49 ) LIMIT 1   [ RunTime:0.000128s ]
SQL: SELECT `title` FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( pid=44 ) LIMIT 1   [ RunTime:0.000112s ]
SQL: SELECT `title` FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( pid=45 ) LIMIT 1   [ RunTime:0.000109s ]
SQL: SELECT `title` FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( pid=47 ) LIMIT 1   [ RunTime:0.000107s ]
SQL: SELECT `title` FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( pid=52 ) LIMIT 1   [ RunTime:0.000106s ]
SQL: SELECT `title` FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( pid=51 ) LIMIT 1   [ RunTime:0.000109s ]
SQL: SELECT `title` FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( pid=39 ) LIMIT 1   [ RunTime:0.000109s ]
SQL: SELECT `title` FROM `ot_category` WHERE ( id=60 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( pid=50 ) LIMIT 1   [ RunTime:0.000106s ]
SQL: SELECT `title` FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( pid=46 ) LIMIT 1   [ RunTime:0.000106s ]
SQL: SELECT `title` FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( pid=29 ) LIMIT 1   [ RunTime:0.000106s ]
SQL: SELECT `title` FROM `ot_category` WHERE ( id=57 ) LIMIT 1   [ RunTime:0.000039s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.020239s ]
INFO: [ view_parse ] --END-- [ RunTime:0.020270s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000032s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000054s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000030s ]
INFO: [ app_end ] --END-- [ RunTime:0.000058s ]

[ 2016-07-25T20:17:05+08:00 ] 27.38.12.207 /index.php?s=/Admin/Article/index/cate_id/61.html
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000336s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000042s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/index%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000251s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000054s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000035s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000047s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000099s ]
SQL: SHOW COLUMNS FROM `ot_auth_group_access` [ RunTime:0.000231s ]
SQL: SELECT `extend_id` FROM ot_auth_group_access g INNER JOIN ot_auth_extend c on g.group_id=c.group_id  WHERE ( g.uid='1' and c.type='1' and !isnull(extend_id) )  [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000330s ]
SQL: SELECT `id`,`title`,`pid`,`allow_publish` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY pid,sort  [ RunTime:0.000047s ]
SQL: SELECT `id`,`title`,`pid` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000047s ]
SQL: SHOW COLUMNS FROM `ot_model` [ RunTime:0.000333s ]
SQL: SELECT * FROM `ot_model` WHERE ( `name` = 'document' ) LIMIT 1   [ RunTime:0.000048s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000331s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( `status` IN ('0','1','2') ) AND ( `pid` = 0 ) AND ( `category_id` = 61 ) LIMIT 1   [ RunTime:0.000194s ]
SQL: SELECT `id`,`uid`,`name`,`title`,`category_id`,`description`,`root`,`pid`,`model_id`,`type`,`position`,`link_id`,`cover_id`,`display`,`deadline`,`attach`,`view`,`comment`,`extend`,`level`,`create_time`,`update_time`,`status` FROM `ot_document` WHERE ( `status` IN ('0','1','2') ) AND ( `pid` = 0 ) AND ( `category_id` = 61 ) ORDER BY level DESC,id DESC LIMIT 0,10   [ RunTime:0.000210s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000175s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000210s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.019021s ]
INFO: [ view_parse ] --END-- [ RunTime:0.019061s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000028s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000050s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000027s ]
INFO: [ app_end ] --END-- [ RunTime:0.000054s ]

[ 2016-07-25T20:17:09+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/add/cate_id/61/model_id/2/pid/0.html
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000343s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000044s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/add%' ) LIMIT 1   [ RunTime:0.000050s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000280s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=4 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000036s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000043s ]
SQL: SHOW COLUMNS FROM `ot_auth_group_access` [ RunTime:0.000240s ]
SQL: SELECT `extend_id` FROM ot_auth_group_access g INNER JOIN ot_auth_extend c on g.group_id=c.group_id  WHERE ( g.uid='1' and c.type='1' and !isnull(extend_id) )  [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000318s ]
SQL: SELECT `id`,`title`,`pid`,`allow_publish` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY pid,sort  [ RunTime:0.000047s ]
SQL: SELECT `id`,`title`,`pid` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000045s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000311s ]
SQL: SHOW COLUMNS FROM `ot_model` [ RunTime:0.000306s ]
SQL: SELECT `extend` FROM `ot_model` WHERE ( `id` = 2 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SHOW COLUMNS FROM `ot_attribute` [ RunTime:0.000290s ]
SQL: SELECT * FROM `ot_attribute` WHERE ( `model_id` IN ('2','1') )  [ RunTime:0.000059s ]
SQL: SELECT `field_sort` FROM `ot_model` WHERE ( `id` = 2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `type` FROM `ot_category` WHERE ( `id` = 61 ) LIMIT 1   [ RunTime:0.000041s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000203s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000241s ]
INFO: [ adminArticleEdit ] --START--
SQL: SHOW COLUMNS FROM `ot_addons` [ RunTime:0.000371s ]
SQL: SELECT `config` FROM `ot_addons` WHERE ( `name` = 'EditorForAdmin' ) AND ( `status` = 1 ) LIMIT 1   [ RunTime:0.000043s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000049s ]
INFO: [ template_filter ] --END-- [ RunTime:-0.008663s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.002234s ]
INFO: [ view_parse ] --END-- [ RunTime:0.002267s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000026s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000047s ]
INFO: Run EditorForAdmin [ RunTime:0.003121s ]
INFO: [ adminArticleEdit ] --END-- [ RunTime:0.003146s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.002533s ]
INFO: [ view_parse ] --END-- [ RunTime:0.002267s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000014s ]
INFO: [ view_filter ] --END-- [ RunTime:-0.000246s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000028s ]
INFO: [ app_end ] --END-- [ RunTime:0.000053s ]

[ 2016-07-25T20:18:10+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000021s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000062s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000375s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000249s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000036s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000310s ]
NOTIC: [2] in_array() expects parameter 2 to be array, string given /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 324 行.
SQL: INSERT INTO `ot_document` (`title`,`name`,`description`,`type`,`display`,`level`,`cover_id`,`view`,`comment`,`create_time`,`link_id`,`id`,`pid`,`model_id`,`category_id`,`uid`,`root`,`attach`,`extend`,`update_time`,`status`,`position`) VALUES ('华为答辩','','',2,1,0,0,0,0,1469449090,0,0,0,2,61,1,0,0,0,1469449090,3,0) [ RunTime:0.000202s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000246s ]
SQL: INSERT INTO `ot_document_article` (`content`,`parse`,`bookmark`,`template`,`id`) VALUES ('',0,0,'',54) [ RunTime:0.000105s ]

[ 2016-07-25T20:19:10+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000060s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000439s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000056s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000034s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000259s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000318s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000140s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449150,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449150,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000123s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000243s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000098s ]

[ 2016-07-25T20:20:10+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000064s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000340s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000058s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000260s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000053s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000328s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000137s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449210,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449210,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000136s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000288s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000098s ]

[ 2016-07-25T20:21:11+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000027s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000071s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000337s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000252s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000309s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000135s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449271,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449271,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000134s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000244s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000115s ]

[ 2016-07-25T20:22:12+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000344s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000262s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000321s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449332,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449332,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000135s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000295s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000116s ]

[ 2016-07-25T20:23:13+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000064s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000342s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000256s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000051s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000363s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000144s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449393,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449393,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000136s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000249s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000103s ]

[ 2016-07-25T20:24:14+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000065s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000337s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000250s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000044s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000346s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000137s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449454,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449454,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000133s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000244s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000101s ]

[ 2016-07-25T20:25:15+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000356s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000048s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000257s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000315s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000136s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449515,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449515,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000136s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000248s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000108s ]

[ 2016-07-25T20:26:16+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000064s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000355s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000051s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000252s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000310s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449576,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449576,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000133s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000252s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000101s ]

[ 2016-07-25T20:27:17+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000340s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000304s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000321s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000137s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449637,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449637,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000135s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000248s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000103s ]

[ 2016-07-25T20:28:18+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000351s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000306s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000111s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000051s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000328s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000139s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449698,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449698,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000141s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000254s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000121s ]

[ 2016-07-25T20:29:18+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000346s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000263s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000364s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000140s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449758,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449758,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000254s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000124s ]

[ 2016-07-25T20:30:19+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000077s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000334s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000255s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000316s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000132s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449819,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449819,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000143s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000250s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000122s ]

[ 2016-07-25T20:31:19+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000381s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000251s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000309s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000135s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449879,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449879,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000143s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000254s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000106s ]

[ 2016-07-25T20:32:19+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000021s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000062s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000344s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000251s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000042s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000308s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000140s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469449939,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469449939,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000132s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000242s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000121s ]

[ 2016-07-25T20:33:20+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000063s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000345s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000260s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000049s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000318s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000141s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450000,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450000,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000133s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000243s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000170s ]

[ 2016-07-25T20:34:21+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000398s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000055s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000277s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000054s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000052s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000318s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000137s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450061,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450061,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000146s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000281s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000230s ]

[ 2016-07-25T20:35:21+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000037s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000078s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000333s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000048s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000256s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000326s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000160s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450121,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450121,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000143s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000258s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000186s ]

[ 2016-07-25T20:36:22+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000337s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000255s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000044s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000315s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450182,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450182,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000135s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000246s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000217s ]

[ 2016-07-25T20:37:23+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000082s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000418s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000044s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000035s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000256s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000065s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000036s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000337s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000155s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450243,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450243,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000152s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000270s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000237s ]

[ 2016-07-25T20:38:24+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000034s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000075s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000383s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000278s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000044s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000314s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450304,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450304,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000151s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000271s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000226s ]

[ 2016-07-25T20:39:25+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000068s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000344s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000256s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000044s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000332s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000162s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450365,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450365,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000161s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000285s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000208s ]

[ 2016-07-25T20:40:26+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000064s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000330s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000261s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000050s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000331s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000134s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450426,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450426,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000138s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000245s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000195s ]

[ 2016-07-25T20:41:27+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000346s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000048s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000264s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000041s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000318s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000141s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450487,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450487,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000257s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000202s ]

[ 2016-07-25T20:42:28+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000334s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000274s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000353s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000139s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450548,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450548,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000150s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000271s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000193s ]

[ 2016-07-25T20:43:29+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000068s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000338s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000048s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000302s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000045s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000324s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000141s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450609,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450609,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000136s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000252s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000210s ]

[ 2016-07-25T20:44:31+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000346s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000049s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000265s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000044s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000043s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000305s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000137s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450671,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450671,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000136s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000250s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000210s ]

[ 2016-07-25T20:45:31+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000068s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000333s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000260s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000041s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000329s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000139s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450731,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450731,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000145s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000250s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000199s ]

[ 2016-07-25T20:46:32+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000346s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000276s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000064s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000324s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000136s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450792,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450792,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000148s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000264s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000225s ]

[ 2016-07-25T20:47:34+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000062s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000367s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000247s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000051s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000326s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000139s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450854,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450854,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000160s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000296s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000212s ]

[ 2016-07-25T20:48:34+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000063s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000336s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000228s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000042s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000036s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000306s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000142s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450914,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450914,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000179s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000240s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000179s ]

[ 2016-07-25T20:49:36+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000369s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000051s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000267s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000046s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000069s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000346s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000141s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469450976,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469450976,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000176s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000240s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000200s ]

[ 2016-07-25T20:50:36+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000021s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000061s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000348s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000069s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000265s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000051s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000056s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000334s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000141s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451036,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451036,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000126s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000338s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000214s ]

[ 2016-07-25T20:51:37+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000345s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000252s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000309s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000145s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451097,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451097,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000134s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000249s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000197s ]

[ 2016-07-25T20:52:38+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000351s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000049s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000284s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000050s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000316s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000139s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451158,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451158,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000136s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000295s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000198s ]

[ 2016-07-25T20:53:39+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000025s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000068s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000336s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000256s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000107s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000047s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000044s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000344s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000140s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451219,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451219,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000138s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000253s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000202s ]

[ 2016-07-25T20:54:40+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000326s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000058s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000254s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000053s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000315s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451280,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451280,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000252s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000201s ]

[ 2016-07-25T20:55:41+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000041s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000085s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000333s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000260s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000315s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000135s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451341,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451341,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000139s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000246s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000202s ]

[ 2016-07-25T20:56:42+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000079s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000360s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000259s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000334s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000171s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451402,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451402,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000134s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000251s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000194s ]

[ 2016-07-25T20:57:43+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000348s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000257s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000046s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000045s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000316s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451463,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451463,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000136s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000252s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000201s ]

[ 2016-07-25T20:58:44+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000064s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000349s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000259s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000052s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000049s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000067s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000308s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000145s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451524,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451524,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000132s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000245s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000203s ]

[ 2016-07-25T20:59:45+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000336s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000248s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000044s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000347s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000173s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451585,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451585,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000174s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000262s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000201s ]

[ 2016-07-25T21:00:46+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000354s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000256s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000318s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000137s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451646,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451646,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000251s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000200s ]

[ 2016-07-25T21:01:47+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000064s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000357s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000254s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000035s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000062s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000350s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000134s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451707,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451707,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000131s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000228s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000189s ]

[ 2016-07-25T21:02:48+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000065s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000341s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000250s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000308s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000136s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451768,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451768,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000142s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000253s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000202s ]

[ 2016-07-25T21:03:49+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000064s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000348s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000255s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000053s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000317s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000135s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451829,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451829,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000255s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000245s ]

[ 2016-07-25T21:04:50+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000359s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000071s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000309s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000049s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000316s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000152s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451890,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451890,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000139s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000256s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000229s ]

[ 2016-07-25T21:05:51+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000068s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000374s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000049s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000265s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000047s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000047s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000036s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000325s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000130s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469451951,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469451951,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000147s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000247s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000213s ]

[ 2016-07-25T21:06:52+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000065s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000363s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000254s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000047s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000049s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000339s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000139s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452012,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452012,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000174s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000261s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000201s ]

[ 2016-07-25T21:07:53+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000069s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000341s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000048s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000266s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000046s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000317s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452073,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452073,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000261s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000198s ]

[ 2016-07-25T21:08:54+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000069s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000363s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000258s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000047s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000315s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000140s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452134,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452134,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000251s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000206s ]

[ 2016-07-25T21:09:55+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000035s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000088s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000337s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000062s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000249s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000067s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000057s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000324s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000153s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452195,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452195,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000142s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000264s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000205s ]

[ 2016-07-25T21:10:56+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000035s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000078s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000343s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000035s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000312s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000050s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000314s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000159s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452256,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452256,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000127s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000274s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000182s ]

[ 2016-07-25T21:11:57+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000027s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000069s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000333s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000250s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000062s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000326s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000135s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452317,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452317,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000136s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000253s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000207s ]

[ 2016-07-25T21:12:58+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000064s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000371s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000055s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000258s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000321s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000145s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452378,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452378,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000140s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000238s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000237s ]

[ 2016-07-25T21:13:59+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000415s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000044s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000035s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000262s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000051s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000305s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452439,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452439,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000125s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000261s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000180s ]

[ 2016-07-25T21:15:00+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000064s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000333s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000251s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000036s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000314s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000129s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452500,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452500,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000130s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000253s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000196s ]

[ 2016-07-25T21:16:01+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000068s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000341s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000259s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000102s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000045s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000044s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000336s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000142s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452561,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452561,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000254s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000199s ]

[ 2016-07-25T21:17:03+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000021s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000060s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000309s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000044s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000254s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000335s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000134s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452623,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452623,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000133s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000296s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000204s ]

[ 2016-07-25T21:18:03+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000340s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000256s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000042s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000081s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000315s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000135s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452683,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452683,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000264s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000201s ]

[ 2016-07-25T21:19:05+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000340s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000233s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000047s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000046s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000035s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000312s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000128s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452745,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452745,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000135s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000229s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000203s ]

[ 2016-07-25T21:20:05+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000078s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000336s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000049s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000274s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000285s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000139s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452805,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452805,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000138s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000317s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000197s ]

[ 2016-07-25T21:21:06+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000341s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000057s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000281s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000334s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000139s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452866,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452866,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000251s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000238s ]

[ 2016-07-25T21:22:07+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000339s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000243s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000368s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000137s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452927,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452927,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000130s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000237s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000206s ]

[ 2016-07-25T21:23:09+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000069s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000340s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000255s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000090s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000046s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000321s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469452989,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469452989,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000135s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000251s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000199s ]

[ 2016-07-25T21:24:09+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000049s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000094s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000349s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000268s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000050s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000335s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000136s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453049,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453049,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000143s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000249s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000201s ]

[ 2016-07-25T21:25:11+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000077s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000352s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000049s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000270s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000077s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000330s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000142s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453111,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453111,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000140s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000272s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000200s ]

[ 2016-07-25T21:26:11+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000336s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000060s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000275s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000047s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000051s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000045s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000319s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000154s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453171,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453171,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000134s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000264s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000191s ]

[ 2016-07-25T21:27:12+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000375s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000057s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000275s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000319s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000137s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453232,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453232,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000142s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000286s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000201s ]

[ 2016-07-25T21:28:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000034s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000077s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000340s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000256s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000326s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000136s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453293,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453293,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000158s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000247s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000196s ]

[ 2016-07-25T21:29:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000347s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000062s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000228s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000281s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000126s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453353,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453353,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000133s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000264s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000195s ]

[ 2016-07-25T21:30:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000080s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000344s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000044s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000321s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000050s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000326s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453413,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453413,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000149s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000249s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000192s ]

[ 2016-07-25T21:31:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000021s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000085s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000339s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000033s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000227s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000051s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000048s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000036s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000374s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000134s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453473,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453473,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000153s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000249s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000196s ]

[ 2016-07-25T21:32:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000068s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000339s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000264s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000042s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000322s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000142s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453533,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453533,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000140s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000259s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000202s ]

[ 2016-07-25T21:33:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000027s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000075s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000357s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000298s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000067s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000051s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000305s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000139s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453593,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453593,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000154s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000271s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000209s ]

[ 2016-07-25T21:34:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000063s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000350s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000057s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000255s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000050s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000110s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000046s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000052s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000078s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000323s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000145s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453653,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453653,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000144s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000251s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000208s ]

[ 2016-07-25T21:35:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000033s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000075s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000389s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000259s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000051s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000312s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000150s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453713,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453713,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000126s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000245s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000196s ]

[ 2016-07-25T21:36:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000407s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000264s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000034s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000035s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000328s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000144s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453773,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453773,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000145s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000259s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000251s ]

[ 2016-07-25T21:37:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000333s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000253s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000043s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000312s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000137s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453833,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453833,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000145s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000251s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000199s ]

[ 2016-07-25T21:38:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000343s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000255s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000331s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000179s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453893,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453893,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000135s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000257s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000239s ]

[ 2016-07-25T21:39:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000063s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000399s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000262s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000044s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000321s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000139s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469453953,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469453953,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000147s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000249s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000222s ]

[ 2016-07-25T21:40:13+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000333s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000262s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000084s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000043s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000316s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454013,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454013,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000255s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000226s ]

[ 2016-07-25T21:41:14+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000065s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000337s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000254s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000046s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000321s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000147s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454074,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454074,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000263s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000224s ]

[ 2016-07-25T21:42:15+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000065s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000345s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000252s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000314s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000135s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454135,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454135,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000134s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000247s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000215s ]

[ 2016-07-25T21:44:18+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000064s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000328s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000044s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000035s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000252s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000075s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000313s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000158s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454258,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454258,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000134s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000248s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000209s ]

[ 2016-07-25T21:44:25+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000090s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000331s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000058s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000277s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000049s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000051s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000333s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000127s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454265,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454265,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000126s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000305s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000196s ]

[ 2016-07-25T21:45:40+08:00 ] 163.125.54.192 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000062s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000335s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000034s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000236s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000036s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000036s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000331s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000130s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454340,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454340,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000134s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000270s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000226s ]

[ 2016-07-25T21:48:01+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000335s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000258s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000310s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000154s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454481,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454481,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000129s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000281s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000191s ]

[ 2016-07-25T21:48:50+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000349s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000044s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000108s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000286s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000054s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000036s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000325s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000176s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454530,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454530,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000162s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000250s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000213s ]

[ 2016-07-25T21:49:56+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000085s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000351s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000035s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000277s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000036s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000048s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000287s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000155s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454596,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454596,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000132s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000256s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000223s ]

[ 2016-07-25T21:50:23+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000041s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000082s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000344s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000253s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000050s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000052s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000311s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000176s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454623,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454623,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000132s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000245s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000213s ]

[ 2016-07-25T21:50:25+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000020s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000063s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000411s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000254s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000035s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000333s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000149s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454625,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454625,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000124s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000266s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000214s ]

[ 2016-07-25T21:51:22+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000065s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000337s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000061s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000282s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000052s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000298s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000135s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454682,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454682,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000134s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000267s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000236s ]

[ 2016-07-25T21:52:22+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000062s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000363s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000049s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000274s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000363s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000144s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454742,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454742,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000146s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000260s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000228s ]

[ 2016-07-25T21:53:21+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000021s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000062s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000357s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000260s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000051s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000367s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454801,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454801,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000257s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000211s ]

[ 2016-07-25T21:54:21+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000063s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000340s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000277s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000333s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454861,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454861,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000143s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000261s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000199s ]

[ 2016-07-25T21:55:21+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000026s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000068s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000343s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000245s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000036s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000305s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000143s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454921,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454921,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000171s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000244s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000212s ]

[ 2016-07-25T21:56:21+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000065s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000393s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000255s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000315s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000136s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469454981,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469454981,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000124s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000260s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000219s ]

[ 2016-07-25T21:57:22+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000068s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000335s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000300s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000320s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000144s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455042,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455042,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000255s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p><br/></p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB&nbsp;</p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000245s ]

[ 2016-07-25T21:58:22+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000331s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000251s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000315s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000135s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455102,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455102,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000133s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000251s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p><br/></p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB&nbsp;</p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000221s ]

[ 2016-07-25T21:59:22+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000019s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000058s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000336s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000264s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000041s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000335s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000142s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455162,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455162,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000169s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000250s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p><br/></p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB&nbsp;</p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000248s ]

[ 2016-07-25T22:00:22+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000026s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000068s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000335s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000043s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000281s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000313s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000147s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455222,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455222,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000135s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000242s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p><br/></p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB&nbsp;</p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000242s ]

[ 2016-07-25T22:01:22+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000066s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000339s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000255s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000044s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000313s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000140s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455282,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455282,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000136s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000251s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p><br/></p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB&nbsp;</p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000232s ]

[ 2016-07-25T22:02:22+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000029s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000073s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000346s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000265s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000326s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000170s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455342,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455342,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000141s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000267s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p><br/></p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB&nbsp;</p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000234s ]

[ 2016-07-25T22:03:23+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000062s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000332s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000045s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000036s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000243s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000050s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000041s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000049s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000331s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000159s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455403,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455403,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000140s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000261s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p><br/></p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB&nbsp;</p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000235s ]

[ 2016-07-25T22:04:22+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000084s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000348s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000043s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000035s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000276s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000053s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000035s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000048s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000043s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000063s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000322s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000174s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455462,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455462,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000138s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000269s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p><br/></p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB&nbsp;</p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000201s ]

[ 2016-07-25T22:05:22+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000062s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000347s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000255s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000044s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000316s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000140s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455522,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455522,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000136s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000252s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p><br/></p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB&nbsp;</p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000221s ]

[ 2016-07-25T22:06:23+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000341s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000255s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000041s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000317s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000138s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455583,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455583,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000259s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB 小型系统。<br/></p><p><br/></p><p>模拟实现了二阶段提交。但是并没有将其运用在实际的工程中。</p><p><br/></p><p>对分布式数据的事务，有了更深刻的理解，更深刻理解面向对象思想在编程中的运用。</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段， 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000250s ]

[ 2016-07-25T22:07:24+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000023s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000065s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000334s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000043s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000034s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000264s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000041s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000307s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000134s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455644,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455644,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000171s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000251s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB 小型系统。<br/></p><p><br/></p><p>模拟实现了二阶段提交。但是并没有将其运用在实际的工程中。</p><p><br/></p><p>对分布式数据的事务，有了更深刻的理解，更深刻理解面向对象思想在编程中的运用。</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段， 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000226s ]

[ 2016-07-25T22:08:24+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000022s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000063s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000351s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000089s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000035s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000236s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000035s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000037s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000327s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000137s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455704,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455704,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000137s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000250s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB 小型系统。<br/></p><p><br/></p><p>模拟实现了二阶段提交。但是并没有将其运用在实际的工程中。</p><p><br/></p><p>对分布式数据的事务，有了更深刻的理解，更深刻理解面向对象思想在编程中的运用。</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段， 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000226s ]

[ 2016-07-25T22:09:24+08:00 ] 27.38.12.207 /index.php?s=/Admin/article/autoSave.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000021s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000062s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000344s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/autosave%' ) LIMIT 1   [ RunTime:0.000037s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000265s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=8 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000042s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000052s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000047s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000325s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000162s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455764,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455764,`status`=3,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000141s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000252s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 547 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB 小型系统。<br/></p><p><br/></p><p>模拟实现了二阶段提交。但是并没有将其运用在实际的工程中。</p><p><br/></p><p>对分布式数据的事务，有了更深刻的理解，更深刻理解面向对象思想在编程中的运用。</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段， 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。</span></p><p><br/></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000229s ]

[ 2016-07-25T22:09:36+08:00 ] 27.38.12.207 /index.php?s=/Admin/Article/update.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000020s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000059s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000350s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000048s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/update%' ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000252s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=7 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000044s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000038s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000321s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000136s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455776,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455776,`status`=1,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000155s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000263s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 178 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB 小型系统。<br/></p><p><br/></p><p>模拟实现了二阶段提交。但是并没有将其运用在实际的工程中。</p><p><br/></p><p>对分布式数据的事务，有了更深刻的理解，更深刻理解面向对象思想在编程中的运用。</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段， 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace;\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(46, 46, 46); font-family: &quot;Microsoft YaHei&quot;, 宋体, &quot;Myriad Pro&quot;, Lato, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 15px; line-height: 24px;  background-color: rgb(255, 255, 255);\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。　能提交阶段－－&gt; 预提交阶段　－－&gt; 最终提交，　已经预提交了　然而没有得到最终提交的指令，还是会提交，从而解决了阻塞。</span></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000243s ]
INFO: [ documentSaveComplete ] --START--
INFO: Run Attachment [ RunTime:0.000128s ]
INFO: [ documentSaveComplete ] --END-- [ RunTime:0.000164s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 189 行.

[ 2016-07-25T22:09:38+08:00 ] 27.38.12.207 /index.php?s=/Admin/Article/index/cate_id/61.html
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000339s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/index%' ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000301s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000036s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000050s ]
SQL: SHOW COLUMNS FROM `ot_auth_group_access` [ RunTime:0.000223s ]
SQL: SELECT `extend_id` FROM ot_auth_group_access g INNER JOIN ot_auth_extend c on g.group_id=c.group_id  WHERE ( g.uid='1' and c.type='1' and !isnull(extend_id) )  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000321s ]
SQL: SELECT `id`,`title`,`pid`,`allow_publish` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY pid,sort  [ RunTime:0.000045s ]
SQL: SELECT `id`,`title`,`pid` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000047s ]
SQL: SHOW COLUMNS FROM `ot_model` [ RunTime:0.000302s ]
SQL: SELECT * FROM `ot_model` WHERE ( `name` = 'document' ) LIMIT 1   [ RunTime:0.000051s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000301s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( `status` IN ('0','1','2') ) AND ( `pid` = 0 ) AND ( `category_id` = 61 ) LIMIT 1   [ RunTime:0.000195s ]
SQL: SELECT `id`,`uid`,`name`,`title`,`category_id`,`description`,`root`,`pid`,`model_id`,`type`,`position`,`link_id`,`cover_id`,`display`,`deadline`,`attach`,`view`,`comment`,`extend`,`level`,`create_time`,`update_time`,`status` FROM `ot_document` WHERE ( `status` IN ('0','1','2') ) AND ( `pid` = 0 ) AND ( `category_id` = 61 ) ORDER BY level DESC,id DESC LIMIT 0,10   [ RunTime:0.000205s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000161s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000220s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.018759s ]
INFO: [ view_parse ] --END-- [ RunTime:0.018796s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000031s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000053s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000030s ]
INFO: [ app_end ] --END-- [ RunTime:0.000060s ]

[ 2016-07-25T22:11:14+08:00 ] 163.125.54.192 /index.php?s=/Admin/Article/edit/id/54/model/1/cate_id/61.html
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000344s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000048s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/edit%' ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000263s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=5 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000039s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000045s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_auth_group_access` [ RunTime:0.000233s ]
SQL: SELECT `extend_id` FROM ot_auth_group_access g INNER JOIN ot_auth_extend c on g.group_id=c.group_id  WHERE ( g.uid='1' and c.type='1' and !isnull(extend_id) )  [ RunTime:0.000042s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000328s ]
SQL: SELECT `id`,`title`,`pid`,`allow_publish` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY pid,sort  [ RunTime:0.000046s ]
SQL: SELECT `id`,`title`,`pid` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000048s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000359s ]
SQL: SELECT `id`,`uid`,`name`,`title`,`category_id`,`description`,`root`,`pid`,`model_id`,`type`,`position`,`link_id`,`cover_id`,`display`,`deadline`,`attach`,`view`,`comment`,`extend`,`level`,`create_time`,`update_time`,`status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000160s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000248s ]
SQL: SELECT `id`,`parse`,`content`,`template`,`bookmark` FROM `ot_document_article` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000142s ]
SQL: SHOW COLUMNS FROM `ot_model` [ RunTime:0.000303s ]
SQL: SELECT `extend` FROM `ot_model` WHERE ( `id` = 2 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SHOW COLUMNS FROM `ot_attribute` [ RunTime:0.000311s ]
SQL: SELECT * FROM `ot_attribute` WHERE ( `model_id` IN ('2','1') )  [ RunTime:0.000061s ]
SQL: SELECT `field_sort` FROM `ot_model` WHERE ( `id` = 2 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT `type` FROM `ot_category` WHERE ( `id` = 61 ) LIMIT 1   [ RunTime:0.000043s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000206s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000251s ]
INFO: [ adminArticleEdit ] --START--
SQL: SHOW COLUMNS FROM `ot_addons` [ RunTime:0.000391s ]
SQL: SELECT `config` FROM `ot_addons` WHERE ( `name` = 'EditorForAdmin' ) AND ( `status` = 1 ) LIMIT 1   [ RunTime:0.000045s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000051s ]
INFO: [ template_filter ] --END-- [ RunTime:-0.008711s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.002206s ]
INFO: [ view_parse ] --END-- [ RunTime:0.002239s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000029s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000050s ]
INFO: Run EditorForAdmin [ RunTime:0.003119s ]
INFO: [ adminArticleEdit ] --END-- [ RunTime:0.003146s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.002621s ]
INFO: [ view_parse ] --END-- [ RunTime:0.002239s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000005s ]
INFO: [ view_filter ] --END-- [ RunTime:-0.000364s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000032s ]
INFO: [ app_end ] --END-- [ RunTime:0.000061s ]

[ 2016-07-25T22:13:16+08:00 ] 163.125.54.192 /index.php?s=/Admin/Article/update.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCache [ RunTime:0.000024s ]
INFO: [ app_begin ] --END-- [ RunTime:0.000067s ]
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000334s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000046s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/update%' ) LIMIT 1   [ RunTime:0.000048s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000255s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=7 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000314s ]
SQL: SELECT `status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000132s ]
SQL: UPDATE `ot_document` SET `title`='华为答辩',`name`='',`description`='',`type`=2,`display`=1,`level`=0,`cover_id`=0,`view`=0,`comment`=0,`create_time`=1469455740,`deadline`=0,`link_id`=0,`pid`=0,`model_id`=2,`category_id`=61,`root`=0,`update_time`=1469455996,`status`=1,`position`=0 WHERE ( `id` = 54 ) [ RunTime:0.000154s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000249s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 178 行.
SQL: UPDATE `ot_document_article` SET `content`='<p>实习期自我总结，从实习培养目标，计划及完成情况进行总结。</p><p><br/></p><p>不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。</p><p><br/></p><p>本次实习我主要 学习mongoDB 分布式数据库的处理，</p><p>我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB 小型系统。<br/></p><p><br/></p><p>模拟实现了二阶段提交。但是并没有将其运用在实际的工程中。</p><p><br/></p><p>对分布式数据的事务，有了更深刻的理解，更深刻理解面向对象思想在编程中的运用。</p><p><br/></p><p><br/></p><p><br/></p><p style=\"margin-top: 8px; margin-bottom: 8px; padding: 0px; border: 0px; list-style: none; word-wrap: break-word; word-break: break-all; line-height: 22.5px; white-space: normal; letter-spacing: 0.5px; font-size: 12.5px; color: rgb(51, 51, 51); font-family: Verdana, sans-serif, 宋体; text-indent: 2em; background-color: rgb(255, 255, 255);\">1，协调者出错，参与者也出错；（二阶段提交的唯一弊端）</p><p style=\"margin-top: 8px; margin-bottom: 8px; padding: 0px; border: 0px; list-style: none; word-wrap: break-word; word-break: break-all; line-height: 22.5px; white-space: normal; letter-spacing: 0.5px; font-size: 12.5px; color: rgb(51, 51, 51); font-family: Verdana, sans-serif, 宋体; text-indent: 2em; background-color: rgb(255, 255, 255);\">2，协调者出错，参与者不出错；（new 一个新协调者）</p><p style=\"margin-top: 8px; margin-bottom: 8px; padding: 0px; border: 0px; list-style: none; word-wrap: break-word; word-break: break-all; line-height: 22.5px; white-space: normal; letter-spacing: 0.5px; font-size: 12.5px; color: rgb(51, 51, 51); font-family: Verdana, sans-serif, 宋体; text-indent: 2em; background-color: rgb(255, 255, 255);\">3，协调者不出错，参与者出错；（二阶段解决，参与者返回失败）</p><p><br/></p><p>mongoDB 性能优化，单文档，二阶段， 三阶段提交， 工作队列，日志系统，版本控制。</p><p><br/></p><p>二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。</p><p>缺点：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\">1、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">同步阻塞问题</strong>。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\">2、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">单点故障</strong>。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\">3、<strong style=\"border: 0px; margin: 0px; padding: 0px;\">数据不一致</strong>。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\">4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\">//ppt 里就不写了</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 0px; padding: 0px; font-size: 15px; color: rgb(94, 94, 94); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\">三阶段提交：</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\">与两阶段提交不同的是，三阶段提交有两个改动点。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\">1、引入超时机制。同时在协调者和参与者中都引入超时机制。<br/>2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\">也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, \" andale=\"\" dejavu=\"\" sans=\"\">CanCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, \" andale=\"\" dejavu=\"\" sans=\"\">PreCommit</code>、<code style=\"border: 0px; margin: 0px; padding: 0px; font-family: Monaco, Consolas, \" andale=\"\" dejavu=\"\" sans=\"\">DoCommit</code>三个阶段。</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\">在DoCommit阶段，不响应的，</p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\"><br/></p><p style=\"border: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px; font-size: 15px; color: rgb(46, 46, 46); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\"><span style=\"color: rgb(46, 46, 46); font-family: \" microsoft=\"\" myriad=\"\" helvetica=\"\" font-size:=\"\" line-height:=\"\" background-color:=\"\">三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。　能提交阶段－－&gt; 预提交阶段　－－&gt; 最终提交，　已经预提交了　然而没有得到最终提交的指令，还是会提交，从而解决了阻塞。</span></p><p>下一步提升计划。</p><p><br/></p>',`parse`=0,`bookmark`=0,`template`='' WHERE ( `id` = 54 ) [ RunTime:0.000241s ]
INFO: [ documentSaveComplete ] --START--
INFO: Run Attachment [ RunTime:0.000086s ]
INFO: [ documentSaveComplete ] --END-- [ RunTime:0.000120s ]
NOTIC: [8] Undefined variable: id /usr/share/nginx/html/Application/Admin/Model/DocumentModel.class.php 第 189 行.

[ 2016-07-25T22:13:18+08:00 ] 163.125.54.192 /index.php?s=/Admin/Article/index/cate_id/61.html
NOTIC: [8192] mysql_connect(): The mysql extension is deprecated and will be removed in the future: use mysqli or PDO instead /usr/share/nginx/html/ThinkPHP/Library/Think/Db/Driver/Mysql.class.php 第 52 行.
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000343s ]
SQL: SELECT * FROM `ot_menu` WHERE ( `pid` = 0 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000047s ]
SQL: SELECT `id` FROM `ot_menu` WHERE ( url like '%Article/index%' ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SHOW COLUMNS FROM `ot_menu` [ RunTime:0.000317s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=3 ) LIMIT 1   [ RunTime:0.000057s ]
SQL: SELECT `id`,`pid`,`title` FROM `ot_menu` WHERE ( id=2 ) LIMIT 1   [ RunTime:0.000040s ]
SQL: SELECT DISTINCT  `group` FROM `ot_menu` WHERE ( pid = 2 )  [ RunTime:0.000040s ]
SQL: SELECT `id`,`url` FROM `ot_menu` WHERE ( `pid` = 2 ) AND ( `hide` = 0 )  [ RunTime:0.000038s ]
SQL: SELECT `id`,`pid`,`title`,`url`,`tip` FROM `ot_menu` WHERE ( `group` = '内容' ) AND ( `pid` = 2 ) AND ( `hide` = 0 ) ORDER BY sort asc  [ RunTime:0.000039s ]
SQL: SHOW COLUMNS FROM `ot_auth_group_access` [ RunTime:0.000232s ]
SQL: SELECT `extend_id` FROM ot_auth_group_access g INNER JOIN ot_auth_extend c on g.group_id=c.group_id  WHERE ( g.uid='1' and c.type='1' and !isnull(extend_id) )  [ RunTime:0.000041s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000323s ]
SQL: SELECT `id`,`title`,`pid`,`allow_publish` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY pid,sort  [ RunTime:0.000046s ]
SQL: SELECT `id`,`title`,`pid` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000046s ]
SQL: SHOW COLUMNS FROM `ot_model` [ RunTime:0.000301s ]
SQL: SELECT * FROM `ot_model` WHERE ( `name` = 'document' ) LIMIT 1   [ RunTime:0.000053s ]
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000306s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( `status` IN ('0','1','2') ) AND ( `pid` = 0 ) AND ( `category_id` = 61 ) LIMIT 1   [ RunTime:0.000204s ]
SQL: SELECT `id`,`uid`,`name`,`title`,`category_id`,`description`,`root`,`pid`,`model_id`,`type`,`position`,`link_id`,`cover_id`,`display`,`deadline`,`attach`,`view`,`comment`,`extend`,`level`,`create_time`,`update_time`,`status` FROM `ot_document` WHERE ( `status` IN ('0','1','2') ) AND ( `pid` = 0 ) AND ( `category_id` = 61 ) ORDER BY level DESC,id DESC LIMIT 0,10   [ RunTime:0.000207s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000152s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000190s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.018534s ]
INFO: [ view_parse ] --END-- [ RunTime:0.018573s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000034s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000055s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000030s ]
INFO: [ app_end ] --END-- [ RunTime:0.000060s ]

[ 2016-07-25T22:32:18+08:00 ] 163.125.54.192 /
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000317s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY view desc LIMIT 0,12   [ RunTime:0.000221s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000372s ]
SQL: SELECT `id`,`name`,`title`,`pid`,`sort`,`list_row`,`meta_title`,`keywords`,`description`,`template_index`,`template_lists`,`template_detail`,`template_edit`,`model`,`type`,`link_id`,`allow_publish`,`display`,`reply`,`check`,`reply_model`,`extend`,`create_time`,`update_time`,`status`,`icon` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000060s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( status=1 ) LIMIT 1   [ RunTime:0.000120s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY create_time desc LIMIT 0,10   [ RunTime:0.000196s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000050s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000050s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000053s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000041s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000041s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000125s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000172s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.010822s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010857s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000040s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000067s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000029s ]
INFO: [ app_end ] --END-- [ RunTime:0.000057s ]

[ 2016-07-25T22:32:42+08:00 ] 163.125.54.192 /index.php?s=/home/article/detail/id/54.html
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000323s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY view desc LIMIT 0,12   [ RunTime:0.000056s ]
SQL: SELECT `id`,`uid`,`name`,`title`,`category_id`,`description`,`root`,`pid`,`model_id`,`type`,`position`,`link_id`,`cover_id`,`display`,`deadline`,`attach`,`view`,`comment`,`extend`,`level`,`create_time`,`update_time`,`status` FROM `ot_document` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000157s ]
SQL: SHOW COLUMNS FROM `ot_document_article` [ RunTime:0.000249s ]
SQL: SELECT `id`,`parse`,`content`,`template`,`bookmark` FROM `ot_document_article` WHERE ( `id` = 54 ) LIMIT 1   [ RunTime:0.000152s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000341s ]
SQL: SELECT `id`,`name`,`title`,`pid`,`sort`,`list_row`,`meta_title`,`keywords`,`description`,`template_index`,`template_lists`,`template_detail`,`template_edit`,`model`,`type`,`link_id`,`allow_publish`,`display`,`reply`,`check`,`reply_model`,`extend`,`create_time`,`update_time`,`status`,`icon` FROM `ot_category` WHERE ( `id` = 61 ) LIMIT 1   [ RunTime:0.000053s ]
SQL: UPDATE `ot_document` SET `view`=view+1 WHERE ( `id` = 54 ) [ RunTime:0.000143s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000082s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000116s ]
SQL: SELECT `id`,`uid`,`name`,`title`,`category_id`,`description`,`root`,`pid`,`model_id`,`type`,`position`,`link_id`,`cover_id`,`display`,`deadline`,`attach`,`view`,`comment`,`extend`,`level`,`create_time`,`update_time`,`status` FROM `ot_document` WHERE ( `id` < '54' ) AND ( `pid` = 0 ) AND ( `category_id` = 61 ) AND ( `status` = 1 ) ORDER BY id DESC LIMIT 1   [ RunTime:0.000221s ]
SQL: SELECT `id`,`uid`,`name`,`title`,`category_id`,`description`,`root`,`pid`,`model_id`,`type`,`position`,`link_id`,`cover_id`,`display`,`deadline`,`attach`,`view`,`comment`,`extend`,`level`,`create_time`,`update_time`,`status` FROM `ot_document` WHERE ( `id` > '54' ) AND ( `pid` = 0 ) AND ( `category_id` = 61 ) AND ( `status` = 1 ) ORDER BY id LIMIT 1   [ RunTime:0.000175s ]
INFO: [ documentDetailAfter ] --START--
SQL: SHOW COLUMNS FROM `ot_attachment` [ RunTime:0.000344s ]
SQL: SELECT `id`,`uid`,`title`,`type`,`source`,`record_id`,`download`,`size`,`dir`,`sort`,`create_time`,`update_time`,`status` FROM `ot_attachment` WHERE ( `record_id` = 54 ) AND ( `status` = 1 )  [ RunTime:0.000115s ]
INFO: Run Attachment [ RunTime:0.000840s ]
SQL: SHOW COLUMNS FROM `ot_addons` [ RunTime:0.000258s ]
SQL: SELECT `config` FROM `ot_addons` WHERE ( `name` = 'SocialComment' ) AND ( `status` = 1 ) LIMIT 1   [ RunTime:0.000043s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000024s ]
INFO: [ template_filter ] --END-- [ RunTime:-0.003736s ]
NOTIC: [8] Undefined variable: addons /usr/share/nginx/html/Runtime/Cache/Home/58bd718024fb066be57959b1979e41a4.php 第 3 行.
INFO: Run Behavior\ParseTemplate [ RunTime:0.001065s ]
INFO: [ view_parse ] --END-- [ RunTime:0.001097s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000028s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000050s ]
INFO: Run SocialComment [ RunTime:0.001787s ]
INFO: [ documentDetailAfter ] --END-- [ RunTime:0.002663s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.001211s ]
INFO: [ view_parse ] --END-- [ RunTime:0.001097s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000004s ]
INFO: [ view_filter ] --END-- [ RunTime:-0.000089s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000032s ]
INFO: [ app_end ] --END-- [ RunTime:0.000059s ]

[ 2016-07-25T22:36:55+08:00 ] 64.246.161.190 /
SQL: SHOW COLUMNS FROM `ot_document` [ RunTime:0.000321s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY view desc LIMIT 0,12   [ RunTime:0.000240s ]
SQL: SHOW COLUMNS FROM `ot_category` [ RunTime:0.000373s ]
SQL: SELECT `id`,`name`,`title`,`pid`,`sort`,`list_row`,`meta_title`,`keywords`,`description`,`template_index`,`template_lists`,`template_detail`,`template_edit`,`model`,`type`,`link_id`,`allow_publish`,`display`,`reply`,`check`,`reply_model`,`extend`,`create_time`,`update_time`,`status`,`icon` FROM `ot_category` WHERE ( `status` = 1 ) ORDER BY sort  [ RunTime:0.000062s ]
SQL: SELECT COUNT(*) AS tp_count FROM `ot_document` WHERE ( status=1 ) LIMIT 1   [ RunTime:0.000122s ]
SQL: SELECT * FROM `ot_document` WHERE ( status=1 ) ORDER BY create_time desc LIMIT 0,10   [ RunTime:0.000192s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000051s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000051s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000045s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000044s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=50 ) LIMIT 1   [ RunTime:0.000043s ]
SQL: SELECT * FROM `ot_category` WHERE ( id=61 ) LIMIT 1   [ RunTime:0.000043s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplace [ RunTime:0.000122s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000158s ]
INFO: Run Behavior\ParseTemplate [ RunTime:0.010879s ]
INFO: [ view_parse ] --END-- [ RunTime:0.010915s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCache [ RunTime:0.000029s ]
INFO: [ view_filter ] --END-- [ RunTime:0.000051s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTrace [ RunTime:0.000029s ]
INFO: [ app_end ] --END-- [ RunTime:0.000074s ]

